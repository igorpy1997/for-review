/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";var t="http://127.0.0.1:8001",e={auth:"/api/admin/me",content:"/api/content",contentImage:"/api/content/image",media:"/api/media",blocks:"/api/blocks",blocksByParent:"/api/blocks/by-parent",deleteBlock:"/api/blocks",reorderBlocks:"/api/blocks/reorder"},r={autoScroll:!0,autoScrollDelay:5e3,maxVisibleCards:4,cardGap:24,minCardWidth:200,selectors:{cardsContainer:'.cards-book[data-section="carousel"]',card:".diagnostic-card",navigation:".carousel-navigation",container:".carousel-container"}},n={selectors:{accordionContainer:'[data-section="accordion"]',caseRow:".row",imageContainer:".image-container",caseImage:".case-image",title:"h4",description:"p"}},o={publishButton:"publish-button"};function i(){return"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?t:window.location.origin}function a(t){return"".concat(e.blocks,"/").concat(t)}function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function u(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function s(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?u(Object(r),!0).forEach((function(e){l(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function l(t,e,r){return(e=function(t){var e=function(t){if("object"!=c(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==c(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function f(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=s(s({},r),t),n=document.querySelectorAll('.cards-book[data-section="carousel"]');n.length?n.forEach((function(t,r){!function(t,e,r){var n=t.querySelectorAll(e.selectors.card);if(n.length){console.log("Initializing carousel #".concat(r," with ").concat(n.length," cards"));var o={currentPosition:0,visibleCards:e.maxVisibleCards,autoScrollInterval:null,originalCardWidth:0,gap:e.cardGap,carouselId:"carousel-".concat(r)};t.id||(t.id=o.carouselId);var i=function(t,e,r){var n,o,i=e.querySelector(".carousel-navigation");if(i)n=i.querySelector(".carousel-prev"),o=i.querySelector(".carousel-next");else{var a=document.createElement("div");a.className="carousel-navigation",a.setAttribute("data-carousel-id",r),(n=document.createElement("button")).className="carousel-prev",n.setAttribute("aria-label","Предыдущий слайд");var c=document.createElement("img");c.src="images/arrow-left.svg",c.alt="← Назад",n.appendChild(c),(o=document.createElement("button")).className="carousel-next",o.setAttribute("aria-label","Следующий слайд");var u=document.createElement("img");u.src="images/arrow-right.svg",u.alt="Вперед →",o.appendChild(u),a.appendChild(n),a.appendChild(o),e.appendChild(a)}return{prevBtn:n,nextBtn:o}}(0,t.closest(".carousel-container")||t.parentElement,o.carouselId);h(t,n,e),o.originalCardWidth=n[0].offsetWidth,d(t,n,i,o),function(t,e,r,n,o){r.prevBtn.addEventListener("click",(function(){v(n),n.currentPosition--,d(t,e,r,n),o.autoScroll&&y(n,(function(){return p(t,e,r,n)}))})),r.nextBtn.addEventListener("click",(function(){v(n),p(t,e,r,n),o.autoScroll&&y(n,(function(){return p(t,e,r,n)}))})),o.autoScroll&&(t.addEventListener("mouseenter",(function(){return v(n)})),t.addEventListener("mouseleave",(function(){return y(n,(function(){return p(t,e,r,n)}))})))}(t,n,i,o,e),e.autoScroll&&y(o,(function(){return p(t,n,i,o)}));var a=function(){return function(t,e,r,n,o){v(n),h(t,e,o),n.originalCardWidth=e[0].offsetWidth,d(t,e,r,n),o.autoScroll&&y(n,(function(){return p(t,e,r,n)}))}(t,n,i,o,e)};document.addEventListener("app:resize",a),t.setAttribute("data-resize-handler-id",o.carouselId),window.carouselResizeHandlers=window.carouselResizeHandlers||{},window.carouselResizeHandlers[o.carouselId]=a,console.log("Carousel #".concat(r," initialized with ").concat(n.length," cards, showing ").concat(e.maxVisibleCards," at once"))}else console.warn("Carousel book #".concat(r," does not contain any cards"))}(t,e,r)})):console.warn("No carousel books found on the page")}function h(t,e,r){if(t&&e.length){var n=t.parentElement.offsetWidth,o=Math.max(r.minCardWidth||200,n/r.maxVisibleCards-r.cardGap);e.forEach((function(t){t.style.minWidth="".concat(o,"px"),t.style.flexBasis="".concat(o,"px")}))}}function d(t,e,r,n){var o=Math.max(0,e.length-n.visibleCards);n.currentPosition=Math.min(Math.max(0,n.currentPosition),o);var i=n.currentPosition*(n.originalCardWidth+n.gap);t.style.transform="translateX(-".concat(i,"px)"),r.prevBtn.disabled=0===n.currentPosition,r.nextBtn.disabled=n.currentPosition>=o,r.prevBtn.style.opacity=r.prevBtn.disabled?"0.5":"1",r.nextBtn.style.opacity=r.nextBtn.disabled?"0.5":"1"}function p(t,e,r,n){n.currentPosition>=e.length-n.visibleCards?n.currentPosition=0:n.currentPosition++,d(t,e,r,n)}function y(t,e){v(t),t.autoScrollInterval=setInterval(e,r.autoScrollDelay)}function v(t){t.autoScrollInterval&&(clearInterval(t.autoScrollInterval),t.autoScrollInterval=null)}function g(t){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(t)}function m(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function b(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?m(Object(r),!0).forEach((function(e){w(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function w(t,e,r){return(e=function(t){var e=function(t){if("object"!=g(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=g(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==g(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function x(t){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x(t)}function E(){E=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function s(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=k(c,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=l(e,r,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===f)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(e,n,new j(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=s;var f={};function h(){}function d(){}function p(){}var y={};u(y,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(P([])));g&&g!==r&&n.call(g,i)&&(y=g);var m=p.prototype=h.prototype=Object.create(y);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,c){var u=l(t[o],t,i);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==x(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(f).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function O(t){this.tryEntries.push(t)}function S(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function j(t){this.tryEntries=[[-1]],t.forEach(O,this),this.reset(!0)}function P(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(x(e)+" is not iterable")}return d.prototype=p,u(m,"constructor",p),u(p,"constructor",d),d.displayName=u(p,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,c,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(s(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(m),u(m,c,"Generator"),u(m,i,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=P,j.prototype={constructor:j,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],c=this.prev,u=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=c){if(c<u)return this.method="next",this.arg=t,n(u),!0;if(c<s)return n(s),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),S(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;S(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:P(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function k(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function O(t){return S.apply(this,arguments)}function S(){var t;return t=E().mark((function t(r){var n;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return",Promise.reject(new Error("No token provided")));case 2:return t.prev=2,t.next=5,fetch("".concat(i()).concat(e.auth),{headers:{Authorization:"Bearer ".concat(r)}});case 5:if((n=t.sent).ok){t.next=8;break}throw new Error("Invalid token");case 8:return t.next=10,n.json();case 10:return t.abrupt("return",t.sent);case 13:throw t.prev=13,t.t0=t.catch(2),console.error("Auth verification failed:",t.t0),t.t0;case 17:case"end":return t.stop()}}),t,null,[[2,13]])})),S=function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){k(i,n,o,a,c,"next",t)}function c(t){k(i,n,o,a,c,"throw",t)}a(void 0)}))},S.apply(this,arguments)}function j(){return!!P()}function P(){return localStorage.getItem("token")}function _(){var t={"Content-Type":"application/json"};return(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&j()&&(t.Authorization="Bearer ".concat(P())),t}var A=["Content-Type"];function C(t){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C(t)}function T(){T=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function s(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=x(c,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=l(e,r,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===f)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(e,n,new O(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=s;var f={};function h(){}function d(){}function p(){}var y={};u(y,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(S([])));g&&g!==r&&n.call(g,i)&&(y=g);var m=p.prototype=h.prototype=Object.create(y);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,c){var u=l(t[o],t,i);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==C(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(f).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function O(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(C(e)+" is not iterable")}return d.prototype=p,u(m,"constructor",p),u(p,"constructor",d),d.displayName=u(p,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,c,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(s(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(m),u(m,c,"Generator"),u(m,i,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,O.prototype={constructor:O,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],c=this.prev,u=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=c){if(c<u)return this.method="next",this.arg=t,n(u),!0;if(c<s)return n(s),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function N(t,e){if(null==t)return{};var r,n,o=function(t,e){if(null==t)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(-1!==e.indexOf(n))continue;r[n]=t[n]}return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],-1===e.indexOf(r)&&{}.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}function I(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function L(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?I(Object(r),!0).forEach((function(e){B(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function B(t,e,r){return(e=function(t){var e=function(t){if("object"!=C(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=C(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==C(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function G(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function F(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){G(i,n,o,a,c,"next",t)}function c(t){G(i,n,o,a,c,"throw",t)}a(void 0)}))}}function z(t,e){return D.apply(this,arguments)}function D(){return D=F(T().mark((function t(e,r){var n,o,a,c,u,s,l,f,h=arguments;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=h.length>2&&void 0!==h[2]?h[2]:null,o=h.length>3&&void 0!==h[3]?h[3]:{},a="".concat(i()).concat(r),c=o.headers||_(!1!==o.auth),u=L({method:e,headers:c},o),n&&(n instanceof FormData?(c["Content-Type"],s=N(c,A),u.headers=s,u.body=n):u.body=JSON.stringify(n)),t.prev=6,t.next=9,fetch(a,u);case 9:if((l=t.sent).ok){t.next=12;break}throw new Error("API request failed: ".concat(l.status," ").concat(l.statusText));case 12:if(!(f=l.headers.get("content-type"))||!f.includes("application/json")){t.next=19;break}return t.next=16,l.json();case 16:case 21:return t.abrupt("return",t.sent);case 19:return t.next=21,l.text();case 22:t.next=28;break;case 24:throw t.prev=24,t.t0=t.catch(6),console.error("API ".concat(e," request failed for ").concat(r,":"),t.t0),t.t0;case 28:case"end":return t.stop()}}),t,null,[[6,24]])}))),D.apply(this,arguments)}function q(t){return M.apply(this,arguments)}function M(){return M=F(T().mark((function t(e){var r,n=arguments;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.length>1&&void 0!==n[1]?n[1]:{},t.abrupt("return",z("GET",e,null,r));case 2:case"end":return t.stop()}}),t)}))),M.apply(this,arguments)}function H(t,e){return R.apply(this,arguments)}function R(){return R=F(T().mark((function t(e,r){var n,o=arguments;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>2&&void 0!==o[2]?o[2]:{},t.abrupt("return",z("POST",e,r,n));case 2:case"end":return t.stop()}}),t)}))),R.apply(this,arguments)}function Y(t,e){return W.apply(this,arguments)}function W(){return W=F(T().mark((function t(e,r){var n,o=arguments;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>2&&void 0!==o[2]?o[2]:{},t.abrupt("return",z("PUT",e,r,n));case 2:case"end":return t.stop()}}),t)}))),W.apply(this,arguments)}function U(t){return V.apply(this,arguments)}function V(){return V=F(T().mark((function t(e){var r,n=arguments;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.length>1&&void 0!==n[1]?n[1]:{},t.abrupt("return",z("DELETE",e,null,r));case 2:case"end":return t.stop()}}),t)}))),V.apply(this,arguments)}function $(t){var e=i();return"".concat(e,"/api/media/").concat(t)}function J(t){return t?t.substring(t.lastIndexOf("/")+1):""}function X(t){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X(t)}function Z(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function K(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Z(Object(r),!0).forEach((function(e){Q(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Z(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Q(t,e,r){return(e=function(t){var e=function(t){if("object"!=X(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=X(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==X(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var tt="success",et="error",rt="info",nt={duration:3e3,position:"bottom-right",closeButton:!1};function ot(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rt,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=K(K({},nt),r),o=document.createElement("div");o.className="notification notification-".concat(e," notification-").concat(n.position),o.textContent=t;var i=Q(Q(Q(Q({},tt,{backgroundColor:"#4CAF50",color:"white"}),et,{backgroundColor:"#F44336",color:"white"}),"warning",{backgroundColor:"#FF9800",color:"white"}),rt,{backgroundColor:"#2196F3",color:"white"});if(Object.assign(o.style,{position:"fixed",padding:"12px 16px",borderRadius:"4px",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.2)",zIndex:"1000",opacity:"0",transition:"opacity 0.3s ease-in-out"},{"top-right":{top:"20px",right:"20px"},"top-left":{top:"20px",left:"20px"},"bottom-right":{bottom:"20px",right:"20px"},"bottom-left":{bottom:"20px",left:"20px"}}[n.position],i[e]),n.closeButton){var a=document.createElement("button");a.innerHTML="&times;",a.style.cssText="\n      position: absolute;\n      top: 5px;\n      right: 5px;\n      background: transparent;\n      border: none;\n      color: inherit;\n      font-size: 16px;\n      cursor: pointer;\n    ",a.addEventListener("click",(function(){o.style.opacity="0",setTimeout((function(){o.remove()}),300)})),o.appendChild(a),o.style.paddingRight="30px"}return document.body.appendChild(o),setTimeout((function(){o.style.opacity="1"}),10),setTimeout((function(){o.style.opacity="0",setTimeout((function(){o.remove()}),300)}),n.duration),o}function it(t){return ot(t,tt,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}function at(t){return ot(t,et,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}function ct(t){return ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ct(t)}function ut(){ut=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function s(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=x(c,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=l(e,r,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===f)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(e,n,new O(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=s;var f={};function h(){}function d(){}function p(){}var y={};u(y,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(S([])));g&&g!==r&&n.call(g,i)&&(y=g);var m=p.prototype=h.prototype=Object.create(y);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,c){var u=l(t[o],t,i);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==ct(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(f).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function O(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(ct(e)+" is not iterable")}return d.prototype=p,u(m,"constructor",p),u(p,"constructor",d),d.displayName=u(p,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,c,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(s(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(m),u(m,c,"Generator"),u(m,i,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,O.prototype={constructor:O,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],c=this.prev,u=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=c){if(c<u)return this.method="next",this.arg=t,n(u),!0;if(c<s)return n(s),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function st(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function lt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){st(i,n,o,a,c,"next",t)}function c(t){st(i,n,o,a,c,"throw",t)}a(void 0)}))}}function ft(t){return ht.apply(this,arguments)}function ht(){return(ht=lt(ut().mark((function t(r){return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",q("".concat(e.blocksByParent,"/").concat(encodeURIComponent(r)),{auth:!1}).catch((function(){return[]})));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function dt(t){return pt.apply(this,arguments)}function pt(){return(pt=lt(ut().mark((function t(r){return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",H(e.blocks,r));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function yt(t){return vt.apply(this,arguments)}function vt(){return(vt=lt(ut().mark((function t(e){return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",U(a(e)));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function gt(){return!!j()||(at("Authentication required to modify blocks"),!1)}var mt={"cards-book":{"diagnostic-card":function(t,e){var r=t.data_block_name,n=document.createElement("article");return n.className=t.class_name,n.setAttribute("data-block-name",r),t.id&&"undefined"!==t.id&&n.setAttribute("data-block-id",t.id),void 0!==t.order&&null!==t.order?n.setAttribute("data-order",String(t.order)):n.setAttribute("data-order","0"),n.style.position="relative",n.innerHTML='\n    <h4 data-content="'.concat(r,'-title"></h4>\n    <p data-content="').concat(r,'-description" data-type="textarea"></p>\n    <div class="image-container">\n      <img class="diagnostic-card-image" src="" alt="" data-content="').concat(r,'-image" data-type="image">\n    </div>\n  '),e.appendChild(n),n}},"accordion-cases":{case:function(t,e){var r=t.data_block_name,n=r.replace("case-",""),o=void 0!==t.order?parseInt(t.order,10)+1:parseInt(n,10)||1,i=document.createElement("div");i.className="accordion-case-item",i.setAttribute("data-block-name",r),t.id&&"undefined"!==t.id&&i.setAttribute("data-block-id",t.id),void 0!==t.order&&null!==t.order?i.setAttribute("data-order",String(t.order)):i.setAttribute("data-order","0"),i.style.position="relative";var a='\n    <div class="accordion-header">\n        <div class="case-number">'.concat(o,'</div>\n        <h4 class = "header-text-accordion" data-content="case-title-').concat(n,'"></h4>\n        <div class="accordion-toggle" aria-label="Развернуть">\n            <svg width="50" height="50" viewBox="0 0 50 50" fill="none" xmlns="http://www.w3.org/2000/svg">\n              <g clip-path="url(#clip0_106010_1019)">\n                <circle cx="25" cy="25" r="25" fill="white" />\n                <path d="M25.0011 15.9082V35.6052M25.0011 35.6052L34.092 27.2718M25.0011 35.6052L15.9102 27.2718" stroke="#0090B8" stroke-width="2.27273" stroke-linecap="round" />\n              </g>\n              <defs>\n                <clipPath id="clip0_106010_1019">\n                  <rect width="50" height="50" fill="white" />\n                </clipPath>\n              </defs>\n            </svg>\n        </div>\n    </div>\n    '),c='\n    <div class="accordion-content collapsed">\n        <div class="accordion-content-inner">\n            <div class="close-accordion" aria-label="Свернуть" type="button">\n            <div class="close-accordion">\n                <svg width="50" height="50" viewBox="0 0 50 50" fill="none" xmlns="http://www.w3.org/2000/svg">\n                  <g clip-path="url(#clip0_104239_7352)">\n                    <circle cx="25" cy="25" r="25" fill="white" />\n                    <path d="M24.9989 35.6074V15.9105M24.9989 15.9105L15.908 24.2438M24.9989 15.9105L34.0898 24.2438" stroke="#0090B8" stroke-width="2.27273" stroke-linecap="round" />\n                  </g>\n                  <defs>\n                    <clipPath id="clip0_104239_7352">\n                      <rect width="50" height="50" fill="white" />\n                    </clipPath>\n                  </defs>\n                </svg>\n           </div>\n\n\n            </div>\n            <div class="col-lg-6 image-half">\n                <div class="case-number">'.concat(o,'</div>\n                <div class="image-container">\n                    <img class="case-image" src="" alt="" data-content="').concat(r,'-image" data-type="image">\n                </div>\n            </div>\n            <div class="col-lg-6 description-half">\n                <h4 data-content="case-title-').concat(n,'"></h4>\n                <p data-content="case-description-').concat(n,'" data-type="textarea"></p>\n                <a class="case-link" href="#">\n                    Читати повний кейс\n                </a>\n            </div>\n        </div>\n    </div>\n    ');i.innerHTML=a+c;var u=i.querySelector(".accordion-toggle"),s=i.querySelector(".accordion-header"),l=i.querySelector(".accordion-content"),f=i.querySelector(".close-accordion"),h=function(t){t.stopPropagation();var e=l.classList.contains("collapsed");if(e){var r=function(t){for(var e=t.parentElement;e;){if(e.hasAttribute("data-section"))return e;e=e.parentElement}return null}(i);r&&r.querySelectorAll(".accordion-case-expanded").forEach((function(t){t!==i&&function(t){var e=t.querySelector(".accordion-header"),r=t.querySelector(".accordion-content"),n=t.querySelector(".accordion-toggle");r.classList.remove("expanded"),r.classList.add("collapsed"),t.classList.remove("accordion-case-expanded");var o=n?n.querySelector(".accordion-icon"):null;o&&(o.textContent="+"),n&&n.setAttribute("aria-label","Развернуть"),r.style.maxHeight="0",e&&(e.style.display="flex"),setTimeout((function(){r.classList.contains("collapsed")&&(r.style.display="none")}),500)}(t)}))}l.classList.toggle("collapsed",!e),l.classList.toggle("expanded",e),i.classList.toggle("accordion-case-expanded",e);var n=u.querySelector(".accordion-icon");if(n&&(n.textContent=e?"−":"+"),u.setAttribute("aria-label",e?"Свернуть":"Развернуть"),e){l.style.display="block";var o=l.scrollHeight;l.style.maxHeight="".concat(o,"px"),s.style.display="none"}else l.style.maxHeight="0",s.style.display="flex",setTimeout((function(){l.classList.contains("collapsed")&&(l.style.display="none")}),500)};return u.addEventListener("click",h),s.addEventListener("click",(function(t){t.target===u||u.contains(t.target)||h(t)})),f.addEventListener("click",h),l.style.maxHeight="0",l.style.display="none",e.appendChild(i),i}}},bt={"diagnostic-card":{name:"diagnostic-card",title:"Диагностическая карточка",description:"Карточка с заголовком, описанием и изображением",allowedParents:["cards-book"],contentFields:[{name:"title",type:"text",label:"Заголовок"},{name:"description",type:"textarea",label:"Описание"},{name:"image",type:"image",label:"Изображение"}],renderPreview:function(t){return'\n      <div class="block-preview diagnostic-card-preview">\n        <h4>'.concat(t.title||"Заголовок карточки","</h4>\n        <p>").concat(t.description||"Описание карточки...",'</p>\n        <div class="image-placeholder"></div>\n      </div>\n    ')}},case:{name:"case",title:"Кейс",description:"Карточка с изображением, заголовком и описанием кейса",allowedParents:["accordion-cases"],contentFields:[{name:"title",type:"text",label:"Заголовок"},{name:"description",type:"textarea",label:"Описание"},{name:"image",type:"image",label:"Изображение"}],renderPreview:function(t){return'\n      <div class="block-preview case-preview">\n        <div class="row">\n          <div class="col-lg-6">\n            <div class="image-placeholder"></div>\n          </div>\n          <div class="col-lg-6">\n            <h4>'.concat(t.title,"</h4>\n            <p>").concat(t.description,"</p>\n          </div>\n        </div>\n      </div>\n    ")}}};function wt(t){var e=t.match(/^([a-zA-Z-]+)(-\d+)?$/);return e?e[1]:t}function xt(t,e){var r=wt(t);return mt[r]&&mt[r][e]?mt[r][e]:null}function Et(t){var e=wt(t);return mt[e]?Object.keys(mt[e]):[]}function kt(t){return kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kt(t)}function Ot(){Ot=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function s(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=x(c,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=l(e,r,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===f)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(e,n,new O(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=s;var f={};function h(){}function d(){}function p(){}var y={};u(y,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(S([])));g&&g!==r&&n.call(g,i)&&(y=g);var m=p.prototype=h.prototype=Object.create(y);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,c){var u=l(t[o],t,i);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==kt(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(f).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function O(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(kt(e)+" is not iterable")}return d.prototype=p,u(m,"constructor",p),u(p,"constructor",d),d.displayName=u(p,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,c,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(s(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(m),u(m,c,"Generator"),u(m,i,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,O.prototype={constructor:O,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],c=this.prev,u=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=c){if(c<u)return this.method="next",this.arg=t,n(u),!0;if(c<s)return n(s),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function St(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function jt(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function Pt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){jt(i,n,o,a,c,"next",t)}function c(t){jt(i,n,o,a,c,"throw",t)}a(void 0)}))}}var _t=new Map;function At(){return(At=Pt(Ot().mark((function t(e){var r;return Ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Array.from(e).map((function(t){var e=t.getAttribute("data-page")||"Home",r=t.getAttribute("data-content");return Ct(t,e,r)})),t.abrupt("return",Promise.all(r));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ct(t,e,r){return Tt.apply(this,arguments)}function Tt(){return(Tt=Pt(Ot().mark((function t(e,r,n){var o,i;return Ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,o="".concat(r,":").concat(n),!_t.has(o)){t.next=4;break}return t.abrupt("return",_t.get(o));case 4:return e.classList.add("content-loading"),t.next=7,Nt(r,n);case 7:if(i=t.sent,e.classList.remove("content-loading"),i){t.next=11;break}return t.abrupt("return",null);case 11:return _t.set(o,i),t.abrupt("return",i);case 15:return t.prev=15,t.t0=t.catch(0),console.error("Error loading content for ".concat(n,":"),t.t0),e.classList.remove("content-loading"),e.classList.add("content-error"),t.abrupt("return",null);case 21:case"end":return t.stop()}}),t,null,[[0,15]])})))).apply(this,arguments)}function Nt(t,e){return It.apply(this,arguments)}function It(){return(It=Pt(Ot().mark((function t(r,n){return Ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",q("".concat(e.content,"?page_title=").concat(encodeURIComponent(r),"&tag_id=").concat(encodeURIComponent(n)),{auth:!1}));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Lt(t){var e,r=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return St(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?St(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){c=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw i}}}}(_t.keys());try{for(r.s();!(e=r.n()).done;){var n=e.value;n.includes(t)&&_t.delete(n)}}catch(t){r.e(t)}finally{r.f()}}function Bt(t,e){e&&("image"===(t.getAttribute("data-type")||"text")&&e.media_path?function(t,e){var r=$(J(e.media_path));"img"===t.tagName.toLowerCase()?function(t,e,r){t.src=e,t.alt=r.tag||r.tagId||"",t.setAttribute("data-original-src",e)}(t,r,e):function(t,e,r){var n=document.createElement("img");n.src=e,n.alt=r.tag||r.tagId||"",n.className=t.className,n.setAttribute("data-original-src",e),Array.from(t.attributes).forEach((function(t){t.name.startsWith("data-")&&n.setAttribute(t.name,t.value)})),t.parentNode&&t.parentNode.replaceChild(n,t)}(t,r,e)}(t,e):e.content&&function(t,e){t.textContent=e.content,t.setAttribute("data-original-content",e.content)}(t,e),function(t,e){e.data_attribute&&t.setAttribute("data-attribute",e.data_attribute),e.block_id&&t.setAttribute("data-block-id",e.block_id)}(t,e))}function Gt(t){var e=this,r=document.createElement("div");r.className="edit-modal",r.innerHTML='\n    <div class="modal-content">\n      '.concat(t,'\n      <div class="buttons">\n        <button class="cancel-btn">Cancel</button>\n        <button class="save-btn">Save Changes</button>\n      </div>\n    </div>\n  '),document.body.appendChild(r);var n=r.querySelector(".save-btn"),o=r.querySelector(".cancel-btn"),i={save:[],cancel:[],close:[]},a=function(t){i[t]&&i[t].length&&i[t].forEach((function(t){return t()}))};function c(){a("close"),r.style.opacity="0",setTimeout((function(){r.remove()}),300)}function u(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];n.disabled=!t,n.style.opacity=t?"1":"0.5",n.style.cursor=t?"pointer":"not-allowed"}return n.addEventListener("click",(function(){a("save")})),o.addEventListener("click",(function(){a("cancel"),c()})),r.addEventListener("click",(function(t){t.target===r&&(a("cancel"),c())})),{element:r,on:function(t,r){return i[t]&&i[t].push(r),e},close:c,enableSave:function(){return u(!0)},disableSave:function(){return u(!1)}}}function Ft(t){return Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ft(t)}function zt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Dt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?zt(Object(r),!0).forEach((function(e){qt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):zt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function qt(t,e,r){return(e=function(t){var e=function(t){if("object"!=Ft(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ft(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ft(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Mt={text:{},image:{}};function Ht(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Mt[t]||(Mt[t]={}),n&&Mt[t][e]?Mt[t][e]=Dt(Dt({},Mt[t][e]),r):Mt[t][e]=r,Yt()}function Rt(){return Object.keys(Mt.text).length>0||Object.keys(Mt.image).length>0}function Yt(){var t=new CustomEvent("pendingChanges:updated",{detail:{count:Object.keys(Mt.text).length+Object.keys(Mt.image).length,hasPending:Rt()}});document.dispatchEvent(t)}function Wt(t){return Wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wt(t)}function Ut(){Ut=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function s(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=x(c,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=l(e,r,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===f)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(e,n,new O(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=s;var f={};function h(){}function d(){}function p(){}var y={};u(y,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(S([])));g&&g!==r&&n.call(g,i)&&(y=g);var m=p.prototype=h.prototype=Object.create(y);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,c){var u=l(t[o],t,i);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==Wt(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(f).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function O(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Wt(e)+" is not iterable")}return d.prototype=p,u(m,"constructor",p),u(p,"constructor",d),d.displayName=u(p,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,c,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(s(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(m),u(m,c,"Generator"),u(m,i,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,O.prototype={constructor:O,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],c=this.prev,u=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=c){if(c<u)return this.method="next",this.arg=t,n(u),!0;if(c<s)return n(s),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function Vt(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function $t(t,e){return Jt.apply(this,arguments)}function Jt(){var t;return t=Ut().mark((function t(r,n){var o,i;return Ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(P()){t.next=3;break}return t.abrupt("return",Promise.reject(new Error("Authentication required")));case 3:if(o=document.querySelector('[data-content="'.concat(r,'"]'))){t.next=7;break}return console.error("Element with tagId ".concat(r," not found")),t.abrupt("return",Promise.reject(new Error("Element with tagId ".concat(r," not found"))));case 7:return i={page_title:n.pageTitle,tag_id:n.tagId,tag:n.tagId,content:n.content,order:1,data_attribute:n.dataAttribute||"text"},n.blockName&&(i.block_name=n.blockName),t.prev=9,t.next=12,H(e.content,i);case 12:return o.setAttribute("data-original-content",n.content),o.classList.remove("content-modified"),t.abrupt("return",r);case 17:throw t.prev=17,t.t0=t.catch(9),console.error("Failed to publish text change for ".concat(r,":"),t.t0),t.t0;case 21:case"end":return t.stop()}}),t,null,[[9,17]])})),Jt=function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Vt(i,n,o,a,c,"next",t)}function c(t){Vt(i,n,o,a,c,"throw",t)}a(void 0)}))},Jt.apply(this,arguments)}function Xt(t){return Xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xt(t)}function Zt(){Zt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function s(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=x(c,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=l(e,r,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===f)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(e,n,new O(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=s;var f={};function h(){}function d(){}function p(){}var y={};u(y,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(S([])));g&&g!==r&&n.call(g,i)&&(y=g);var m=p.prototype=h.prototype=Object.create(y);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,c){var u=l(t[o],t,i);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==Xt(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(f).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function O(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Xt(e)+" is not iterable")}return d.prototype=p,u(m,"constructor",p),u(p,"constructor",d),d.displayName=u(p,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,c,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(s(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(m),u(m,c,"Generator"),u(m,i,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,O.prototype={constructor:O,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],c=this.prev,u=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=c){if(c<u)return this.method="next",this.arg=t,n(u),!0;if(c<s)return n(s),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function Kt(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function Qt(t,e){return te.apply(this,arguments)}function te(){var t;return t=Zt().mark((function t(e,r){var n;return Zt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r.element&&"function"==typeof r.element.setAttribute?(r.element.setAttribute("data-original-src",r.newUrl),r.element.classList&&r.element.classList.remove("content-modified")):(console.warn("Element for tagId ".concat(e," is not a valid DOM element or is missing")),(n=document.querySelector('[data-content="'.concat(e,'"]')))&&(n.setAttribute("data-original-src",r.newUrl),n.classList.remove("content-modified"))),t.abrupt("return",e);case 5:throw t.prev=5,t.t0=t.catch(0),console.error("Failed to finalize image change for ".concat(e,":"),t.t0),t.t0;case 9:case"end":return t.stop()}}),t,null,[[0,5]])})),te=function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Kt(i,n,o,a,c,"next",t)}function c(t){Kt(i,n,o,a,c,"throw",t)}a(void 0)}))},te.apply(this,arguments)}var ee=new Set;function re(t){var r=t.parentNode;if(!r||!r.classList.contains("editable-wrapper")){var n=function(){var t=document.createElement("div");return t.className="editable-wrapper",t}(),i=function(){var t=document.createElement("button");return t.className="edit-btn",t.innerHTML='\n    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">\n      <path d="M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207 11.207 2.5zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293l6.5-6.5zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z"/>\n    </svg>\n  ',t.style.display="block",t}();if(t.parentNode){t.parentNode.insertBefore(n,t),n.appendChild(t),n.appendChild(i);var a=function(r){r.preventDefault(),r.stopPropagation(),"image"===(t.getAttribute("data-type")||"text")?function(t){var r=t.getAttribute("data-page")||"Home",n=t.getAttribute("data-content"),i=t.getAttribute("data-block-name")||function(t){for(var e=t.parentElement;e;){if(e.hasAttribute("data-block-name"))return e.getAttribute("data-block-name");e=e.parentElement}return""}(t),a=t.getAttribute("data-attribute")||"image",c="";"img"===t.tagName.toLowerCase()&&(c=t.src);var u=Gt("\n    <h3>Edit Image</h3>\n    ".concat(c?'<div class="current-image"><img src="'.concat(c,'" alt="Current image" style="max-width: 100%; max-height: 200px; object-fit: contain;"></div>'):"",'\n    <div class="file-input-container">\n      <input type="file" id="image-upload" accept="image/*">\n      <label for="image-upload" class="file-label">Choose a file</label>\n    </div>\n    <div class="file-name" id="file-name"></div>\n    ').concat(i?'<div class="block-info">Block: '.concat(i,"</div>"):"","\n  ")),s=document.getElementById("image-upload"),l=document.getElementById("file-name");s.addEventListener("change",(function(){s.files.length>0?(l.textContent=s.files[0].name,u.enableSave()):(l.textContent="",u.disableSave())})),u.on("save",(function(){s.files.length>0&&function(t,r){if(!P())return Promise.reject(new Error("Authentication required"));var n=new FormData;n.append("file",r.file),n.append("page_title",r.pageTitle),n.append("tag_id",r.tagId),n.append("tag",r.tagId),n.append("order",1),n.append("data_attribute",r.dataAttribute||"image"),r.blockName&&n.append("block_name",r.blockName),t.classList.add("loading"),"img"===t.tagName.toLowerCase()&&(t.style.opacity="0.5"),H(e.contentImage,n).then((function(e){if(e&&e.media_path){var n=$(J(e.media_path));if(Ht("image",r.tagId,{pageTitle:r.pageTitle,tagId:r.tagId,newUrl:n,element:t,mediaPath:e.media_path,blockName:r.blockName,dataAttribute:r.dataAttribute||"image"}),"img"===t.tagName.toLowerCase())t.src=n,t.style.opacity="1",t.classList.add("content-modified"),t.classList.remove("loading");else{var i=document.createElement("img");i.src=n,i.alt=r.tagId,i.className=t.className+" content-modified",Array.from(t.attributes).forEach((function(t){t.name.startsWith("data-")&&i.setAttribute(t.name,t.value)})),t.parentNode.replaceChild(i,t),Ht("image",r.tagId,{element:i},!0)}var a=document.getElementById(o.publishButton);a&&(a.style.display="block")}})).catch((function(e){throw console.error("Error uploading image for ".concat(r.tagId,":"),e),t.classList.remove("loading"),"img"===t.tagName.toLowerCase()&&(t.style.opacity="1"),e}))}(t,{pageTitle:r,tagId:n,file:s.files[0],blockName:i,dataAttribute:a}),u.close()}))}(t):function(t){var e=t.getAttribute("data-page")||"Home",r=t.getAttribute("data-content"),n=t.getAttribute("data-type")||"text",i=t.getAttribute("data-block-name")||function(t){for(var e=t.parentElement;e;){if(e.hasAttribute("data-block-name"))return e.getAttribute("data-block-name");e=e.parentElement}return""}(t),a=t.getAttribute("data-attribute")||function(t){return"textarea"===t?"html":"text"}(n),c=t.textContent.trim(),u=Gt("textarea"===n?'\n      <h3>Edit Content</h3>\n      <textarea id="content-input" rows="5" placeholder="Enter content">'.concat(c,"</textarea>\n      ").concat(i?'<div class="block-info">Block: '.concat(i,"</div>"):"","\n    "):'\n      <h3>Edit Content</h3>\n      <input type="text" id="content-input" value="'.concat(c,'" placeholder="Enter content">\n      ').concat(i?'<div class="block-info">Block: '.concat(i,"</div>"):"","\n    ")),s=document.getElementById("content-input");s.focus(),s.select(),u.on("save",(function(){var n=s.value.trim();n&&function(t,e){Ht("text",e.tagId,{pageTitle:e.pageTitle,tagId:e.tagId,content:e.content,blockName:e.blockName,dataAttribute:e.dataAttribute}),t.textContent=e.content,t.classList.add("content-modified");var r=document.getElementById(o.publishButton);r&&(r.style.display="block")}(t,{pageTitle:e,tagId:r,content:n,blockName:i,dataAttribute:a}),u.close()}))}(t)};i.addEventListener("click",a),ee.add({element:i,type:"click",handler:a})}}}function ne(t){return ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ne(t)}function oe(){oe=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function s(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=x(c,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=l(e,r,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===f)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(e,n,new O(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=s;var f={};function h(){}function d(){}function p(){}var y={};u(y,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(S([])));g&&g!==r&&n.call(g,i)&&(y=g);var m=p.prototype=h.prototype=Object.create(y);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,c){var u=l(t[o],t,i);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==ne(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(f).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function O(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(ne(e)+" is not iterable")}return d.prototype=p,u(m,"constructor",p),u(p,"constructor",d),d.displayName=u(p,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,c,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(s(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(m),u(m,c,"Generator"),u(m,i,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,O.prototype={constructor:O,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],c=this.prev,u=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=c){if(c<u)return this.method="next",this.arg=t,n(u),!0;if(c<s)return n(s),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function ie(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function ae(){var t;return t=oe().mark((function t(){var e,r,n,i,a,c,u,s;return oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(j()){t.next=4;break}return console.error("Authentication required to publish changes"),at("Authentication required to publish changes"),t.abrupt("return");case 4:if(Rt()){t.next=7;break}return console.error("No changes to publish"),t.abrupt("return");case 7:for(i in(e=document.getElementById(o.publishButton))&&(e.textContent="Publishing...",e.disabled=!0),r=JSON.parse(JSON.stringify({text:Mt.text,image:Mt.image})),n=[],r.text)n.push($t(i,r.text[i]));for(a in r.image)n.push(Qt(a,r.image[a]));return t.prev=13,t.next=16,Promise.all(n);case 16:for(u in c=t.sent,console.log("Published changes for:",c),r.text)Lt(u);for(s in r.image)Lt(s);Mt.text={},Mt.image={},Yt(),e&&(e.textContent="Publish Changes",e.disabled=!1,e.style.display="none"),it("Changes published successfully!"),t.next=30;break;case 25:t.prev=25,t.t0=t.catch(13),console.error("Error publishing changes:",t.t0),at("Error publishing changes"),e&&(e.textContent="Publish Changes",e.disabled=!1);case 30:case"end":return t.stop()}}),t,null,[[13,25]])})),ae=function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){ie(i,n,o,a,c,"next",t)}function c(t){ie(i,n,o,a,c,"throw",t)}a(void 0)}))},ae.apply(this,arguments)}function ce(t){return ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ce(t)}function ue(){ue=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function s(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=x(c,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=l(e,r,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===f)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(e,n,new O(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=s;var f={};function h(){}function d(){}function p(){}var y={};u(y,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(S([])));g&&g!==r&&n.call(g,i)&&(y=g);var m=p.prototype=h.prototype=Object.create(y);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,c){var u=l(t[o],t,i);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==ce(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(f).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function O(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(ce(e)+" is not iterable")}return d.prototype=p,u(m,"constructor",p),u(p,"constructor",d),d.displayName=u(p,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,c,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(s(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(m),u(m,c,"Generator"),u(m,i,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,O.prototype={constructor:O,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],c=this.prev,u=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=c){if(c<u)return this.method="next",this.arg=t,n(u),!0;if(c<s)return n(s),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function se(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return le(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?le(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){c=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw i}}}}function le(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function fe(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}var he={isInitialized:!1,isAuthenticating:!1,isEditorActive:!1};function de(){console.log("Initializing content editor..."),he.isInitialized&&ve();var t=document.getElementById("auth-status");return t&&(t.innerHTML=""),function(){pe.apply(this,arguments)}(),j()?(he.isAuthenticating=!0,O(P()).then((function(){document.querySelectorAll("[data-content]").forEach(re),function(){var t=document.getElementById(o.publishButton);t&&t.remove();var e=function(){var t=document.createElement("button");return t.id="publish-button",t.textContent="Publish Changes",t.className="publish-btn",Object.assign(t.style,{position:"fixed",bottom:"20px",right:"20px",padding:"12px 20px",backgroundColor:"#4CAF50",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",boxShadow:"0 2px 5px rgba(0,0,0,0.2)",zIndex:"1000",display:"none",fontWeight:"500",fontSize:"14px",transition:"background-color 0.3s"}),t.addEventListener("mouseover",(function(){t.style.backgroundColor="#45a049"})),t.addEventListener("mouseout",(function(){t.style.backgroundColor="#4CAF50"})),t}();document.body.appendChild(e);var r=function(){!function(){ae.apply(this,arguments)}()};e.addEventListener("click",r),ee.add({element:e,type:"click",handler:r});var n=function(t){e.style.display=t.detail.hasPending?"block":"none",t.detail.count>0?e.textContent="Publish Changes (".concat(t.detail.count,")"):e.textContent="Publish Changes"};document.addEventListener("pendingChanges:updated",n),ee.add({element:document,type:"pendingChanges:updated",handler:n}),e.style.display=Rt()?"block":"none"}(),he.isEditorActive=!0,he.isAuthenticating=!1,console.log("Content editor initialized for authenticated user")})).catch((function(t){console.error("Authentication failed:",t),localStorage.removeItem("token"),he.isAuthenticating=!1}))):console.log("Content editor initialized in view-only mode"),he.isInitialized=!0,{loadContentForNewElements:ye,cleanupEditor:ve}}function pe(){var t;return t=ue().mark((function t(){var e,r,n,o,i,a,c;return ue().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,e=document.querySelectorAll("[data-content]"),r=se(e),t.prev=3,r.s();case 5:if((n=r.n()).done){t.next=17;break}return o=n.value,i=o.getAttribute("data-page")||"Home",a=o.getAttribute("data-content"),o.classList.add("content-loading"),t.next=12,Ct(o,i,a);case 12:c=t.sent,o.classList.remove("content-loading"),c&&Bt(o,c);case 15:t.next=5;break;case 17:t.next=22;break;case 19:t.prev=19,t.t0=t.catch(3),r.e(t.t0);case 22:return t.prev=22,r.f(),t.finish(22);case 25:console.log("Content loaded successfully"),t.next=31;break;case 28:t.prev=28,t.t1=t.catch(0),console.error("Error loading content:",t.t1);case 31:case"end":return t.stop()}}),t,null,[[0,28],[3,19,22,25]])})),pe=function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){fe(i,n,o,a,c,"next",t)}function c(t){fe(i,n,o,a,c,"throw",t)}a(void 0)}))},pe.apply(this,arguments)}function ye(t){(function(t){return At.apply(this,arguments)})(t).then((function(e){t.forEach((function(t,r){Bt(t,e[r])})),j()&&he.isEditorActive&&t.forEach(re)})).catch((function(t){console.error("Error loading content for new elements:",t)}))}function ve(){ee.forEach((function(t){t.element.removeEventListener(t.type,t.handler)})),ee.clear(),he.isEditorActive=!1}function ge(t){return function(t){if(Array.isArray(t))return me(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return me(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?me(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function me(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var be={pendingBlocks:[],pendingDeleteBlocks:[],blockCounters:{},inited:!1,loadedSections:{},blockOrderData:{}};function we(t){be.loadedSections[t]=!0}function xe(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];be.inited=t}function Ee(t){return Ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ee(t)}function ke(){ke=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function s(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=x(c,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=l(e,r,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===f)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(e,n,new O(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=s;var f={};function h(){}function d(){}function p(){}var y={};u(y,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(S([])));g&&g!==r&&n.call(g,i)&&(y=g);var m=p.prototype=h.prototype=Object.create(y);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,c){var u=l(t[o],t,i);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==Ee(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(f).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function O(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Ee(e)+" is not iterable")}return d.prototype=p,u(m,"constructor",p),u(p,"constructor",d),d.displayName=u(p,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,c,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(s(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(m),u(m,c,"Generator"),u(m,i,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,O.prototype={constructor:O,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],c=this.prev,u=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=c){if(c<u)return this.method="next",this.arg=t,n(u),!0;if(c<s)return n(s),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function Oe(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Se(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}var je={initialized:!1,sections:new Map,draggedElement:null,dragoverElement:null,dragStartY:0,originalOrder:[],blockOrders:[],hasReordered:!1,dragPosition:null};function Pe(t){if(t){var e=t.getAttribute("data-section");if(e&&!je.sections.has(e)){var r=Array.from(t.children).filter((function(t){return t.hasAttribute("data-block-name")}));r.length&&(je.sections.set(e,{element:t,blocks:new Map}),r.forEach((function(t,r){_e(t,e,r)})),t.addEventListener("dragover",Ie),t.addEventListener("dragenter",Le),t.addEventListener("dragleave",Be),t.addEventListener("drop",Ge),je.initialized=!0)}}}function _e(t,e,r){if(t){var n=t.getAttribute("data-block-id"),o=t.getAttribute("data-block-name"),i=r;if(t.hasAttribute("data-order")){var a=t.getAttribute("data-order");if(null!=a){var c=parseInt(a,10);isNaN(c)||(i=c)}}!function(t){if(!t.querySelector(".block-drag-handle")){var e=document.createElement("div");e.className="block-drag-handle",e.title="Drag to reorder",e.innerHTML='\n    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n      <line x1="8" y1="6" x2="21" y2="6"></line>\n      <line x1="8" y1="12" x2="21" y2="12"></line>\n      <line x1="8" y1="18" x2="21" y2="18"></line>\n      <line x1="3" y1="6" x2="3.01" y2="6"></line>\n      <line x1="3" y1="12" x2="3.01" y2="12"></line>\n      <line x1="3" y1="18" x2="3.01" y2="18"></line>\n    </svg>\n  ',e.style.cssText="\n    position: absolute;\n    top: 10px;\n    left: 10px;\n    width: 24px;\n    height: 24px;\n    cursor: grab;\n    z-index: 10;\n    opacity: 0.6;\n    transition: opacity 0.3s;\n    background-color: rgba(255, 255, 255, 0.8);\n    border-radius: 4px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  ",e.addEventListener("mouseover",(function(){e.style.opacity="1"})),e.addEventListener("mouseout",(function(){e.style.opacity="0.6"})),"static"===getComputedStyle(t).position&&(t.style.position="relative"),t.appendChild(e)}}(t),t.setAttribute("draggable","true"),t.setAttribute("data-order",String(i));var u=je.sections.get(e);u&&u.blocks.set(n||o,{element:t,id:n||o,name:o,order:i}),t.addEventListener("dragstart",Ae),t.addEventListener("dragend",Ce),t.addEventListener("dragover",Te),t.addEventListener("dragleave",Ne)}}function Ae(t){je.draggedElement=t.currentTarget,t.dataTransfer.effectAllowed="move",je.dragStartY=t.clientY||(t.touches&&t.touches[0]?t.touches[0].clientY:0);var e=Fe(je.draggedElement);if(e){var r=e.getAttribute("data-section"),n=je.sections.get(r);n&&(je.originalOrder=Array.from(n.blocks.values()).sort((function(t,e){return t.order-e.order})).map((function(t){return{id:t.id,order:t.order}})))}je.draggedElement.classList.add("dragging");var o=je.draggedElement.cloneNode(!0);o.style.opacity="0.7",o.style.position="absolute",o.style.top="-1000px",document.body.appendChild(o),t.dataTransfer.setDragImage(o,10,10),setTimeout((function(){document.body.removeChild(o)}),0)}function Ce(t){if(je.draggedElement){je.draggedElement.classList.remove("dragging");var e=Fe(je.draggedElement);if(e&&e.querySelectorAll("[data-block-name]").forEach((function(t){t.classList.remove("drag-over"),t.classList.remove("drag-over-top"),t.classList.remove("drag-over-bottom")})),je.hasReordered){var r=Fe(je.draggedElement);r&&function(t){if(je.blockOrders.length){var e=document.querySelector('[data-section="'.concat(t,'"]'));if(e)(function(t,e){be.blockOrderData[t]=e,window.blockOrderData=be.blockOrderData})(t,{parent_block:e.id||e.getAttribute("class"),block_orders:je.blockOrders}),it("Block order will be updated after publishing changes")}}(r.getAttribute("data-section"))}je.draggedElement=null,je.dragoverElement=null,je.dragPosition=null,je.hasReordered=!1}}function Te(t){if(je.draggedElement&&t.currentTarget!==je.draggedElement){t.preventDefault(),t.stopPropagation();var e=t.currentTarget,r=e.getBoundingClientRect(),n=t.clientY-r.top<r.height/2;e.classList.remove("drag-over"),e.classList.remove("drag-over-top"),e.classList.remove("drag-over-bottom"),n?(e.classList.add("drag-over-top"),je.dragPosition="before"):(e.classList.add("drag-over-bottom"),je.dragPosition="after"),je.dragoverElement=e}}function Ne(t){var e=t.currentTarget;e.classList.remove("drag-over-top"),e.classList.remove("drag-over-bottom")}function Ie(t){t.preventDefault(),t.dataTransfer.dropEffect="move"}function Le(t){t.preventDefault()}function Be(t){t.relatedTarget&&t.currentTarget.contains(t.relatedTarget)||je.dragoverElement&&(je.dragoverElement.classList.remove("drag-over-top"),je.dragoverElement.classList.remove("drag-over-bottom"),je.dragoverElement=null)}function Ge(t){if(t.preventDefault(),je.draggedElement&&je.dragoverElement){var e=je.draggedElement,r=je.dragoverElement,n=je.dragPosition;if(e!==r){var o=Fe(e),i=Fe(r);if(o&&i)if(o===i){var a=o,c=a.getAttribute("data-section"),u=je.sections.get(c);if(u){"before"===n?a.insertBefore(e,r):a.insertBefore(e,r.nextSibling),ze(u),je.hasReordered=!0,r.classList.remove("drag-over-top"),r.classList.remove("drag-over-bottom"),je.dragoverElement=null,e.classList.add("block-reordered"),setTimeout((function(){e.classList.remove("block-reordered")}),1e3);var s=new CustomEvent("blockOrderChanged",{detail:{section:a,blocks:je.blockOrders}});document.dispatchEvent(s)}}else at("Drag and drop between different sections is not supported")}}}function Fe(t){if(!t)return null;for(var e=t.parentElement;e;){if(e.hasAttribute("data-section"))return e;e=e.parentElement}return null}function ze(t){t&&t.element&&(Array.from(t.element.querySelectorAll("[data-block-name]")).forEach((function(e,r){var n=e.getAttribute("data-block-id"),o=e.getAttribute("data-block-name"),i=n||o,a=t.blocks.get(i);if(a&&(a.order=r,e.setAttribute("data-order",String(r)),t.element.classList.contains("accordion-cases"))){var c=r+1,u=e.querySelector(".accordion-header .case-number");u&&(u.textContent=c);var s=e.querySelector(".accordion-content .case-number");s&&(s.textContent=c)}})),je.blockOrders=Array.from(t.blocks.values()).map((function(t){try{var e=t.id;return e&&e!==t.name?{block_id:e,order:t.order}:null}catch(e){return console.warn("Error parsing block ID: ".concat(t.id),e),null}})).filter((function(t){return null!==t})))}function De(t,e){return qe.apply(this,arguments)}function qe(){var t;return t=ke().mark((function t(r,n){var o;return ke().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Y(e.reorderBlocks,n);case 3:return it("Block order successfully updated"),t.abrupt("return",!0);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error updating block order:",t.t0),at("Failed to update block order"),(o=document.querySelector('[data-section="'.concat(r,'"]')))&&Me(o),t.abrupt("return",!1);case 14:case"end":return t.stop()}}),t,null,[[0,7]])})),qe=function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Se(i,n,o,a,c,"next",t)}function c(t){Se(i,n,o,a,c,"throw",t)}a(void 0)}))},qe.apply(this,arguments)}function Me(t){if(t&&je.originalOrder.length){var e=t.getAttribute("data-section"),r=je.sections.get(e);r&&(je.originalOrder.map((function(t){var e=r.blocks.get(t.id.toString());return e?e.element:null})).filter(Boolean).forEach((function(e){t.appendChild(e)})),ze(r))}}function He(){var t="block-draggable-styles";if(!document.getElementById(t)){var e=document.createElement("style");e.id=t,e.textContent="\n    [draggable=true] {\n      user-select: none;\n      -webkit-user-drag: element;\n      position: relative;\n      transition: transform 0.2s, box-shadow 0.2s;\n    }\n    \n    .dragging {\n      opacity: 0.6;\n      border: 2px dashed #4285f4 !important;\n      transform: scale(0.98);\n      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);\n      z-index: 10;\n    }\n    \n    .drag-over-top {\n      border-top: 2px solid #4285f4;\n      padding-top: 8px;\n      margin-top: -8px;\n      position: relative;\n    }\n    \n    .drag-over-top::before {\n      content: '';\n      position: absolute;\n      top: -2px;\n      left: 0;\n      right: 0;\n      height: 2px;\n      background-color: #4285f4;\n      z-index: 5;\n    }\n    \n    .drag-over-bottom {\n      border-bottom: 2px solid #4285f4;\n      padding-bottom: 8px;\n      margin-bottom: -8px;\n      position: relative;\n    }\n    \n    .drag-over-bottom::after {\n      content: '';\n      position: absolute;\n      bottom: -2px;\n      left: 0;\n      right: 0;\n      height: 2px;\n      background-color: #4285f4;\n      z-index: 5;\n    }\n    \n    .block-drag-handle:hover {\n      opacity: 1 !important;\n      transform: scale(1.1);\n    }\n    \n    .block-drag-handle:active {\n      cursor: grabbing;\n      cursor: -webkit-grabbing;\n    }\n    \n    .block-drag-handle:active svg {\n      transform: scale(0.9);\n    }\n    \n    @keyframes blockHighlight {\n      0% { box-shadow: 0 0 0 rgba(66, 133, 244, 0); }\n      50% { box-shadow: 0 0 10px rgba(66, 133, 244, 0.5); }\n      100% { box-shadow: 0 0 0 rgba(66, 133, 244, 0); }\n    }\n    \n    .block-reordered {\n      animation: blockHighlight 1s ease-in-out;\n    }\n  ",document.head.appendChild(e)}}function Re(){He(),document.querySelectorAll("[data-section]").forEach(Pe)}function Ye(t){if(t){var e=Fe(t);if(e){var r=e.getAttribute("data-section");if(r){e.id||e.getAttribute("class");var n=je.sections.get(r);n||(Pe(e),n=je.sections.get(r)),n&&_e(t,r,Math.max.apply(Math,(o=Array.from(n.blocks.values()).map((function(t){return t.order})),function(t){if(Array.isArray(t))return Oe(t)}(o)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(o)||function(t,e){if(t){if("string"==typeof t)return Oe(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Oe(t,e):void 0}}(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat([-1]))+1)}}}var o}function We(){var t=window.blockOrderData||{},e=[];for(var r in t)e.push(De(r,t[r]));return e}var Ue={initSortable:Pe,initAllSortables:Re,makeBlockDraggable:Ye,publishBlockOrders:We};function Ve(t,e){if(t&&!t.querySelector(".block-delete-button")){var r=document.createElement("button");r.className="block-delete-button",r.innerHTML="&#10006;",r.title="Delete block",r.style.cssText="\n    position: absolute;\n    top: 10px;\n    right: 10px;\n    background-color: #ff4d4d;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    width: 30px;\n    height: 30px;\n    cursor: pointer;\n    font-size: 16px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    z-index: 10;\n    opacity: 0.8;\n    transition: opacity 0.3s;\n  ",r.addEventListener("mouseover",(function(){r.style.opacity="1"})),r.addEventListener("mouseout",(function(){r.style.opacity="0.8"})),r.addEventListener("click",(function(r){r.stopPropagation(),$e(t,e)})),"static"===getComputedStyle(t).position&&(t.style.position="relative"),t.appendChild(r)}}function $e(t,e){var r,n,o;if(gt()&&confirm("Are you sure you want to delete this block? This action cannot be undone."))if(e)r=t,n=e,o=t.style.display||"block",be.pendingDeleteBlocks.push({element:r,id:n,originalDisplay:o||"block"}),t.style.display="none",it("Block will be deleted after publishing changes");else{var i=t.getAttribute("data-block-name");t.remove(),function(t){be.pendingBlocks=be.pendingBlocks.filter((function(e){return e.data_block_name!==t}))}(i),it("New block deleted")}}function Je(t,e){if(!gt())return null;var r=t.id||t.getAttribute("class"),n=wt(r),o=Et(r);if(!o.includes(e))return console.error("[BlockSystem] Block type ".concat(e," is not allowed in section ").concat(r," (base type: ").concat(n,")")),console.log("[BlockSystem] Available block types for ".concat(n,":"),o),at("Block type ".concat(e," is not allowed in section ").concat(r)),null;var i=function(t){return be.blockCounters[t]||(be.blockCounters[t]=0),++be.blockCounters[t]}(e),a="".concat(e,"-").concat(i),c=-1;Array.from(t.querySelectorAll("[data-block-id]")).forEach((function(t){if(t.hasAttribute("data-order")){var e=t.getAttribute("data-order");if(null!=e){var r=parseInt(e,10);isNaN(r)||(c=Math.max(c,r))}}}));var u={class_name:e,data_block_name:a,parent_block:r,order:c+1},s=xt(r,e);if(!s)return console.error("[BlockSystem] Block creator not found for type: ".concat(e," in section ").concat(r," (base type: ").concat(n,")")),console.log("[BlockSystem] Available creators:",blockCreators),at("Block creator not found for type: ".concat(e)),null;var l=s(u,t);return l.setAttribute("data-order",String(u.order)),function(t){be.pendingBlocks.push(t)}(u),Ve(l),Ze(l),it("Added new ".concat(e," block")),l.setAttribute("draggable","true"),Ye(l),setTimeout(Ke,300),l}function Xe(t,e){var r=e.id||e.getAttribute("class"),n=t.class_name,o=t.data_block_name,i=t.order,a=xt(r,n);if(!a)return console.warn("[BlockSystem] Block creator not found: ".concat(n," for section ").concat(r)),null;var c=a(t,e);null!=i?c.setAttribute("data-order",String(i)):c.setAttribute("data-order","0"),j()&&(t.id?Ve(c,t.id):Ve(c),c.setAttribute("draggable","true"),Ye(c));var u=null==o?void 0:o.match(/^(.+)-(\d+)$/);return u&&u[1]===n&&function(t,e){(!be.blockCounters[t]||be.blockCounters[t]<e)&&(be.blockCounters[t]=e)}(n,parseInt(u[2],10)),c}function Ze(t){ye(t.querySelectorAll("[data-content]"))}function Ke(){try{window.carousel=window.carousel||{},window.carousel.initialized=!1,console.log("Reinitializing all carousels..."),window.carouselResizeHandlers&&Object.keys(window.carouselResizeHandlers).forEach((function(t){document.removeEventListener("app:resize",window.carouselResizeHandlers[t])})),window.carousel=window.carousel||{},window.carousel.initialized=!1,f()}catch(t){console.error("[BlockSystem] Carousel initialization error:",t)}}function Qe(t){return Qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qe(t)}function tr(){tr=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function s(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=x(c,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=l(e,r,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===f)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(e,n,new O(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=s;var f={};function h(){}function d(){}function p(){}var y={};u(y,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(S([])));g&&g!==r&&n.call(g,i)&&(y=g);var m=p.prototype=h.prototype=Object.create(y);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,c){var u=l(t[o],t,i);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==Qe(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(f).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function O(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Qe(e)+" is not iterable")}return d.prototype=p,u(m,"constructor",p),u(p,"constructor",d),d.displayName=u(p,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,c,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(s(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(m),u(m,c,"Generator"),u(m,i,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,O.prototype={constructor:O,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],c=this.prev,u=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=c){if(c<u)return this.method="next",this.arg=t,n(u),!0;if(c<s)return n(s),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function er(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function rr(){return nr.apply(this,arguments)}function nr(){var t;return t=tr().mark((function t(){var e,r,n;return tr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(gt()){t.next=2;break}return t.abrupt("return");case 2:if(be.pendingBlocks.length>0||be.pendingDeleteBlocks.length>0||Object.keys(be.blockOrderData).length>0){t.next=5;break}return at("No changes to publish"),t.abrupt("return");case 5:if(t.prev=5,e=ge(be.pendingBlocks),r=ge(be.pendingDeleteBlocks),!(e.length>0)){t.next=14;break}return t.next=12,Promise.all(e.map((function(t){return dt(t)})));case 12:t.sent.forEach((function(t,r){var n=e[r],o=document.querySelector('[data-block-name="'.concat(n.data_block_name,'"]'));if(o&&t.id){o.setAttribute("data-block-id",t.id);var i=o.querySelector(".block-delete-button");if(i){var a=i.cloneNode(!0);i.parentNode.replaceChild(a,i),a.addEventListener("click",(function(e){e.stopPropagation(),$e(o,t.id)}))}else Ve(o,t.id);o.hasAttribute("draggable")&&"true"===o.getAttribute("draggable")||Ye(o),o.classList.add("block-reordered"),setTimeout((function(){o.classList.remove("block-reordered")}),1e3)}}));case 14:if(!(Object.keys(be.blockOrderData).length>0)){t.next=26;break}if(t.prev=15,!((n=We()).length>0)){t.next=20;break}return t.next=20,Promise.all(n);case 20:t.next=26;break;case 22:t.prev=22,t.t0=t.catch(15),console.error("[BlockSystem] Error publishing block order changes:",t.t0),at("Error updating block order");case 26:if(!(r.length>0)){t.next=29;break}return t.next=29,Promise.all(r.map((function(t){return yt(t.id).then((function(){return t.element&&t.element.parentNode&&t.element.remove(),!0})).catch((function(e){return console.error("[BlockSystem] Error deleting block ".concat(t.id,":"),e),t.element&&(t.element.style.display=t.originalDisplay||"block"),!1}))})));case 29:be.pendingBlocks=[],be.pendingDeleteBlocks=[],be.blockOrderData={},it("Block changes published successfully!"),setTimeout(Ke,300),t.next=38;break;case 34:t.prev=34,t.t1=t.catch(5),console.error("[BlockSystem] Error publishing blocks:",t.t1),at("Error publishing block changes. Check console for details.");case 38:case"end":return t.stop()}}),t,null,[[5,34],[15,22]])})),nr=function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){er(i,n,o,a,c,"next",t)}function c(t){er(i,n,o,a,c,"throw",t)}a(void 0)}))},nr.apply(this,arguments)}function or(t){O(P()).then((function(){var e=t.id||t.getAttribute("class"),r=Et(e),n=document.createElement("div");n.className="section-controls",n.style.cssText="\n        margin-bottom: 15px;\n        background-color: #f8f9fa;\n        border-radius: 8px;\n        padding: 10px;\n        display: flex;\n        gap: 10px;\n        align-items: center;\n        flex-wrap: wrap;\n      ";var o,i,a=document.createElement("span");if(a.textContent="Section: ".concat(e),a.style.fontWeight="500",a.style.marginRight="auto",n.appendChild(a),r.length>1){var c=(o=r,(i=document.createElement("select")).style.cssText="\n    padding: 8px;\n    border-radius: 4px;\n    border: 1px solid #ccc;\n  ",o.forEach((function(t){var e=document.createElement("option"),r=function(t){return bt[t]||null}(t);e.value=t,e.textContent=(null==r?void 0:r.title)||t,i.appendChild(e)})),i),u=ir("Add Block",(function(){var e=c.value;Je(t,e)}));n.appendChild(c),n.appendChild(u)}else n.appendChild(ir("Add Block",(function(){return Je(t,r[0])})));n.appendChild(ir("Publish Block Changes",rr)),t.parentNode.insertBefore(n,t)})).catch((function(t){console.error("[BlockSystem] Authorization error for section panel:",t)}))}function ir(t,e){var r=document.createElement("button");return r.textContent=t,r.style.cssText="\n    padding: 8px 16px;\n    background-color: #4285f4;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-weight: 500;\n    transition: background-color 0.3s;\n  ",r.addEventListener("mouseover",(function(){return r.style.backgroundColor="#3367d6"})),r.addEventListener("mouseout",(function(){return r.style.backgroundColor="#4285f4"})),r.addEventListener("click",e),r}function ar(t){return ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ar(t)}function cr(){cr=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function s(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=x(c,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=l(e,r,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===f)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(e,n,new O(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=s;var f={};function h(){}function d(){}function p(){}var y={};u(y,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(S([])));g&&g!==r&&n.call(g,i)&&(y=g);var m=p.prototype=h.prototype=Object.create(y);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,c){var u=l(t[o],t,i);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==ar(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(f).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function k(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function O(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(ar(e)+" is not iterable")}return d.prototype=p,u(m,"constructor",p),u(p,"constructor",d),d.displayName=u(p,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,c,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(s(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(m),u(m,c,"Generator"),u(m,i,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,O.prototype={constructor:O,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],c=this.prev,u=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=c){if(c<u)return this.method="next",this.arg=t,n(u),!0;if(c<s)return n(s),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;k(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function ur(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return sr(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?sr(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){c=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw i}}}}function sr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function lr(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function fr(){return hr.apply(this,arguments)}function hr(){var t;return t=cr().mark((function t(){var e,r,n,o;return cr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((e=document.querySelectorAll("[data-section]")).length){t.next=3;break}return t.abrupt("return");case 3:t.prev=3,r=ur(e),t.prev=5,o=cr().mark((function t(){var e,r,o,i,a;return cr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=n.value,r=e.id||e.getAttribute("class"),console.log("Using section ID: ".concat(r)),c=r,be.loadedSections[c]){t.next=9;break}return t.next=6,ft(r);case 6:(o=t.sent).length&&(i=o.sort((function(t,e){return(void 0!==t.order?parseInt(t.order,10):parseInt(t.id,10))-(void 0!==e.order?parseInt(e.order,10):parseInt(e.id,10))})),console.log("Sorted blocks:",i),a=Array.from(e.children).filter((function(t){return!t.hasAttribute("data-block-name")})),e.innerHTML="",a.forEach((function(t){return e.appendChild(t)})),i.forEach((function(t){return Xe(t,e)}))),we(r);case 9:Ze(e),j()&&(or(e),Pe(e));case 11:case"end":return t.stop()}var c}),t)})),r.s();case 8:if((n=r.n()).done){t.next=12;break}return t.delegateYield(o(),"t0",10);case 10:t.next=8;break;case 12:t.next=17;break;case 14:t.prev=14,t.t1=t.catch(5),r.e(t.t1);case 17:return t.prev=17,r.f(),t.finish(17);case 20:xe(!0),j()&&He(),setTimeout(Ke,0),t.next=28;break;case 25:t.prev=25,t.t2=t.catch(3),console.error("[BlockSystem] Initialization error:",t.t2);case 28:case"end":return t.stop()}}),t,null,[[3,25],[5,14,17,20]])})),hr=function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){lr(i,n,o,a,c,"next",t)}function c(t){lr(i,n,o,a,c,"throw",t)}a(void 0)}))},hr.apply(this,arguments)}function dr(t){return dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dr(t)}function pr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function yr(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?pr(Object(r),!0).forEach((function(e){vr(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):pr(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function vr(t,e,r){return(e=function(t){var e=function(t){if("object"!=dr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=dr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==dr(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}yr(yr({},{addBlock:Je,publishChanges:rr,deleteBlock:$e,initBlockSystem:fr,reinitCarousel:Ke,processNewBlock:function(t){t&&(Ze(t),j()&&Ye(t))},makeDraggable:Ye}),{},{sortable:Ue});var gr={debounce:function(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return function(){for(var n=this,o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];clearTimeout(e),e=setTimeout((function(){return t.apply(n,i)}),r)}},initialize:function(){console.log("Initializing application...");try{f(r),console.log("Carousel initialized")}catch(t){console.error("Failed to initialize carousel:",t)}try{(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=(b(b({},n),t),document.querySelectorAll('[data-section="accordion"]'));e.length?e.forEach((function(t,e){t.querySelectorAll(".accordion-case-item").length>0||!t.classList.contains("accordion-cases")?function(t){t.querySelectorAll(".accordion-case-item").forEach((function(t){var e=t.querySelector(".header-text"),r=t.querySelector(".description-half h4");e&&r&&(new MutationObserver((function(t){e.textContent=r.textContent})).observe(r,{childList:!0,characterData:!0,subtree:!0}),e.textContent=r.textContent)}))}(t):function(t){if(console.log("Creating empty accordion structure for",t),window.loadContentForNewElements){var e=t.querySelectorAll("[data-content]");window.loadContentForNewElements(e)}else if("function"==typeof loadContentForNewElements)try{var r=t.querySelectorAll("[data-content]");loadContentForNewElements(r)}catch(t){console.warn("Could not load content for accordion elements:",t)}}(t),console.log("Accordion section #".concat(e," ready with ").concat(t.querySelectorAll(".accordion-case-item").length," cases"))})):console.log("No accordion sections found on the page")})(n),console.log("Accordion initialized")}catch(t){console.error("Failed to initialize accordion:",t)}try{if(fr(),console.log("Block system initialized"),j())try{Re(),console.log("Block sortable initialized")}catch(t){console.error("Failed to initialize block sortable:",t)}}catch(t){console.error("Failed to initialize block system:",t)}try{de(),console.log("Content editor initialized")}catch(t){console.error("Failed to initialize content editor:",t)}console.log("Application initialized successfully")},handleResize:null};gr.handleResize=gr.debounce((function(){var t=new CustomEvent("app:resize",{detail:{width:window.innerWidth,height:window.innerHeight}});document.dispatchEvent(t)}),150),document.addEventListener("DOMContentLoaded",gr.initialize),window.addEventListener("resize",gr.handleResize)})();